{% extends 'base.html' %}

{% block title %}Asset Details{% endblock %}

{% block content %}
<div class="mb-10">
    <a href="/equipment"
        class="text-[var(--text-secondary)] hover:text-[var(--text-primary)] text-[10px] font-black uppercase tracking-widest flex items-center gap-2 mb-6 transition-all">
        <i class="fas fa-arrow-left text-[8px]"></i> Back to Inventory
    </a>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div
        class="mb-8 p-4 rounded-xl text-center text-[10px] font-black uppercase tracking-widest {{ 'bg-red-500/10 text-red-500 border border-red-500/20' if category == 'error' else 'bg-[var(--text-primary)]/10 text-[var(--text-primary)] border border-[var(--text-primary)]/20' }}">
        {{ message }}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-8">
        <div class="flex items-center gap-8">
            <div
                class="w-20 h-20 bg-[var(--text-primary)] text-[var(--bg-pure)] rounded-3xl flex items-center justify-center font-black text-3xl italic rotate-3">
                {{ equipment.name[:1] }}
            </div>
            <div>
                <h3 class="text-4xl font-black uppercase tracking-tighter italic text-[var(--text-primary)]">{{
                    equipment.name }}</h3>
                <p class="text-[10px] font-bold text-[var(--text-secondary)] uppercase tracking-[0.3em] mt-1">{{
                    equipment.serial_number }} // {{ equipment.department }}</p>
            </div>
        </div>

        <div class="flex gap-4">
            <!-- Smart Button -->
            <a href="/equipment/{{ equipment.id }}/requests"
                class="bg-[var(--bg-alt)] border border-[var(--border-main)] px-8 py-4 rounded-2xl flex items-center gap-4 hover:border-[var(--text-primary)] transition-all group">
                <i
                    class="fas fa-terminal text-[var(--text-secondary)] group-hover:text-[var(--text-primary)] transition-colors"></i>
                <div class="text-left">
                    <p class="text-[8px] text-[var(--text-secondary)] font-bold uppercase tracking-[0.2em]">Maintenance
                        Queue</p>
                    <p class="text-xs font-bold text-[var(--text-primary)] uppercase">{{ requests_count }} Active
                        Ticket(s)</p>
                </div>
            </a>

            {% if not equipment.is_scrapped %}
            <form action="/equipment/{{ equipment.id }}/scrap" method="POST"
                onsubmit="return confirm('Are you sure you want to decommission this asset?');" class="h-full">
                <button type="submit"
                    class="h-full bg-[var(--bg-pure)] hover:bg-red-600 text-[var(--text-secondary)] hover:text-[#ffffff] border border-[var(--border-main)] hover:border-red-600 px-8 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all">
                    Decommission
                </button>
            </form>
            {% else %}
            <div
                class="h-full bg-[var(--bg-alt)] text-[var(--text-secondary)] border border-[var(--border-main)] px-8 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest">
                Out of Service
            </div>
            {% endif %}
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
    <div class="lg:col-span-2 space-y-10">
        <!-- Technical Details -->
        <div class="glass-card rounded-3xl p-10 border-[var(--border-main)]">
            <h4
                class="text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-[0.25em] mb-10 border-b border-[var(--border-main)] pb-4">
                Engineering Profile</h4>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-10">
                <div>
                    <label
                        class="block text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-widest mb-2">Location
                        Code</label>
                    <p class="text-sm font-bold text-[var(--text-primary)] uppercase tracking-tight">{{
                        equipment.location }}</p>
                </div>
                <div>
                    <label
                        class="block text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-widest mb-2">Asset
                        Class</label>
                    <p class="text-sm font-bold text-[var(--text-primary)] uppercase tracking-tight">{{
                        equipment.category.name if
                        equipment.category else 'UNCLASSIFIED' }}</p>
                </div>
                <div>
                    <label
                        class="block text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-widest mb-2">Unit
                        Assigned</label>
                    <p class="text-sm font-bold text-[var(--text-primary)] uppercase tracking-tight">{{
                        equipment.maintenance_team.name
                        }}</p>
                </div>
                <div>
                    <label
                        class="block text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-widest mb-2">Commission
                        Date</label>
                    <p class="text-sm font-bold text-[var(--text-primary)] uppercase tracking-tight">{{
                        equipment.purchase_date.strftime('%Y-%m-%d') }}</p>
                </div>
                <div class="sm:col-span-2">
                    <label
                        class="block text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-widest mb-2">Warranty
                        /
                        Service Level</label>
                    <p class="text-sm font-bold text-[var(--text-primary)] uppercase tracking-tight">{{
                        equipment.warranty_info or 'NONE
                        LOGGED' }}</p>
                </div>
            </div>
        </div>

        <!-- History -->
        <div class="glass-card rounded-3xl p-10 border-[var(--border-main)] opacity-40">
            <h4 class="text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-[0.25em] mb-10 pb-4">
                Operation History
            </h4>
            <div class="text-center py-16 border border-dashed border-[var(--border-main)] rounded-2xl">
                <i class="fas fa-layer-group text-2xl text-[var(--bg-alt)] mb-6"></i>
                <p class="text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-widest">No Historical
                    Anomalies Found
                </p>
            </div>
        </div>
    </div>

    <div class="space-y-10">
        <!-- Ownership -->
        <div class="glass-card rounded-3xl p-8 border-[var(--border-main)]">
            <h4 class="text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-[0.25em] mb-6">Custody
            </h4>
            <div class="flex items-center gap-4 p-5 bg-[var(--bg-alt)] border border-[var(--border-main)] rounded-2xl">
                <div
                    class="w-12 h-12 rounded-xl bg-[var(--text-primary)] text-[var(--bg-pure)] flex items-center justify-center font-black text-xs italic">
                    {{ equipment.owner_name[:2]|upper }}</div>
                <div>
                    <p class="text-[11px] font-bold text-[var(--text-primary)] uppercase tracking-tight">{{
                        equipment.owner_name }}</p>
                    <p class="text-[9px] font-black text-[var(--text-secondary)] uppercase tracking-widest">Authorized
                        User</p>
                </div>
            </div>
        </div>

        <!-- Stats -->
        <div class="glass-card rounded-3xl p-8 border-[var(--border-main)]">
            <h4 class="text-[10px] font-black text-[var(--text-secondary)] uppercase tracking-[0.25em] mb-6">System
                Health</h4>
            <div class="space-y-6">
                <div class="flex justify-between items-center text-[10px] font-black uppercase tracking-widest">
                    <span class="text-[var(--text-secondary)]">Stability Index</span>
                    <span class="text-[var(--text-primary)]">98%</span>
                </div>
                <div class="w-full h-1 bg-[var(--bg-alt)] rounded-full overflow-hidden">
                    <div class="h-full bg-[var(--text-primary)] transition-all duration-1000" style="width: 98%"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}